# rb-malware-agent

## Overview

This is a tool for query and obtain data from the redBorder's Malware API. There are two types of data that can be obtained:

- IPs scores
- File hashes score

It stores the data on two separated files, one for hashes (files analyzed) and another for IPs that have a score higher than a number that you can specify.

## Usage

Usage of redborder-malware-agent:

```
  -interval int
        Interval in seconds between updates (default 300)
  -min_score float
        Min score to add to the blacklist (default 50)
  -url string
        API url
  -whitelist
        File to add entries with score < min_score
```

## Examples

If you want to get a files with IP and hashes with score greater than 25 you can do the following:

```bash
./agent -url http:10.0.150.77:7777/reputation/v1/malware -min_score 25
```

You will find the next files:

- `hashes_blacklist`
- `ips_blacklist`

You can also get a whitelist with the flag `-whitelist`

```bash
./agent -url http:10.0.150.77:7777/reputation/v1/malware -whitelist
```

So you will get two additional files with scores lower than 25 (in this case)

- `hashes_whitelist`
- `ips_whitelist`

## Documentation

To view the documentation just execute:

```bash
godoc -http=:6060
```

And open on a browser: [http://localhost:6060/pkg/redborder/malware-agent/](http://localhost:6060/pkg/redborder/malware-agent/)