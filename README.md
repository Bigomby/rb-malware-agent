# rb-malware-agent

## Overview

This is a tool for query and obtain data from the redBorder's Malware API. There are two types of data that can be obtained:

- IPs scores
- File hashes score

It stores the data on two separated files, one for hashes (files analyzed) and another for IPs that have a score higher than a number that you can specify.

## Usage

Usage of redborder-malware-agent:

```
  -interval int
        Interval in seconds between updates
  -min_score float
        Min score to add to the blacklist (default 50)
  -socket_dir string
        Unix socket control directory
  -timeout int
        Socket timeout (default 5)
  -url string
        API url
  -whitelist
        File to add entries with score < min_score
```

## Examples

If you want to get a file with IP and hashes containing scores greater than 25 you can do the following:

```bash
./agent -url http:10.0.150.77:7777/reputation/v1/malware -min_score 25
```

You will find the next files:

- `hashes_blacklist`
- `ips_blacklist`

You can also get a whitelist with the flag `-whitelist`

```bash
./agent -url http:10.0.150.77:7777/reputation/v1/malware -whitelist
```

So you will get two additional files with scores lower than 25 (in this case)

- `hashes_whitelist`
- `ips_whitelist`

Also if you want to notify snort to reload blacklists you can provide a UNIX socket.

```bash
./agent -url http:10.0.150.77:7777/reputation/v1/malware -socket_dir /etc/snort/groupname/cs
```

The application will send a hash reload message to instance 0 (`/etc/snort/groupname/cs/instance-0/SNORT.sock`) and a IP reload notification to all instances (`/etc/snort/groupname/cs/instance-*/SNORT.sock`).

## Documentation

To view the documentation just execute:

```bash
godoc -http=:6060
```

And open on a browser: [http://localhost:6060/pkg/redborder/malware-agent/](http://localhost:6060/pkg/redborder/malware-agent/)