# rb-malware-agent

## Overview

This is a tool for query and obtain data from the redBorder's Malware API. There are two types of data that can be obtained:

- IPs scores
- File hashes score

It stores the data on two separated files, one for hashes (files analyzed) and another for IPs that have a score higher than a 
number that you can specify. After the data is gathered from the API, the app can notify snort via snortcontrol unix socket.

## Usage

Usage of redborder-malware-agent:

```
  -config string
        Config file
  -debug
        Print debug info
```

## Examples

This is an example config file:

```yaml
url: "http://10.0.161.177:7777/reputation/v1/malware"
min_score: 50
ip_blacklist: "iplists/black.list"
ip_whitelist: "iplists/seen.list"
hash_blacklist: "files/black.list"
hash_whitelist: "files/seen.list"
interval: 0
snort_socket_path: "/etc/snort/0/cs"
snort_socket_timeout: 5
```

- **url**: address of the API to connect.
- **min_score**: Fles and IPs with score greather than this value goes to the blacklist and 
those which score lower than this value goes to the whitelist.
- **ip_blacklist**, **ip_whitelist**, **hash_blacklist**, **hash_whitelist**: Stores information got from the API.
- **interval**: time in seconds between calls to the API.
- **snort_socket_path**: Path to the `/instance-i/SNORT.socket` file. 
- **snort_socket_timeout**: Max time to wait for snort response after the notification is sent.

## Documentation

To view the documentation just execute:

```bash
godoc -http=:6060
```

And open on a browser: [http://localhost:6060/pkg/redborder/malware-agent/](http://localhost:6060/pkg/redborder/malware-agent/)
